<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Карточка + CTR — APNG only (Scale-X/Y + Tuner)</title>
  <style>
    :root{
      --scale-x: 1.000;
      --scale-y: 1.000;
      --clip-t: 0; --clip-r: 0; --clip-b: 0; --clip-l: 0;
      --site-bg:#000;
    }
    body{margin:0; background:var(--site-bg); color:#fff; font-family:sans-serif;}
    .wrap{max-width:1200px; margin:auto; padding:20px}

    .stage{position:relative; max-width:760px; aspect-ratio:2048/1828; margin:auto;}
    .layer{position:absolute; inset:0; width:100%; height:100%; object-fit:contain; opacity:0;}
    .veo.apng{
      display:block;
      object-fit:contain;
      transform:scaleX(var(--scale-x)) scaleY(var(--scale-y));
      clip-path:inset(var(--clip-t) var(--clip-r) var(--clip-b) var(--clip-l));
    }
    .device,.s1,.s2,.s3,.s4,.s5{
      transform:scaleX(var(--scale-x)) scaleY(var(--scale-y));
    }

    /* ====== TUNER ====== */
    .tuner-toggle{position:fixed; right:12px; bottom:12px; z-index:100;
      background:#2b2e36; color:#fff; border:none; padding:8px 12px; border-radius:20px; cursor:pointer;}
    .tuner{position:fixed; left:12px; right:12px; bottom:50px; z-index:99;
      background:rgba(20,20,24,.9); padding:12px; border-radius:12px; display:none;}
    .tuner.open{display:block;}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); gap:10px;}
    .row{display:flex; flex-direction:column; font-size:12px;}
    .row label{display:flex; justify-content:space-between;}
    .btns{margin-top:10px; display:flex; gap:8px;}
    button{padding:6px 10px; border-radius:6px; cursor:pointer;}
    .primary{background:#3a7afe; color:#fff; border:none;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="stage">
      <img class="layer device" src="assets/step1.png" style="opacity:1">
      <img class="layer s1" src="assets/step2.png">
      <img class="layer s2" src="assets/step3.png">
      <img class="layer s3" src="assets/step4.png">
      <img class="layer s4" src="assets/step5.png">
      <img class="layer s5" src="assets/step6.png">
      <img class="layer veo apng" id="veo_apng" src="assets/veo.apng">
    </div>
  </div>

  <!-- tuner -->
  <button class="tuner-toggle" id="tunerToggle">Тюнинг</button>
  <div class="tuner" id="tuner">
    <div class="grid">
      <div class="row"><label>Scale-X <span id="vx">1.000</span></label><input type="range" id="scale_x" min="0.8" max="1.4" step="0.001" value="1.000"></div>
      <div class="row"><label>Scale-Y <span id="vy">1.000</span></label><input type="range" id="scale_y" min="0.8" max="1.4" step="0.001" value="1.000"></div>
      <div class="row"><label>Clip-Top <span id="vt">0</span>%</label><input type="range" id="clip_t" min="0" max="10" step="0.1" value="0"></div>
      <div class="row"><label>Clip-Right <span id="vr">0</span>%</label><input type="range" id="clip_r" min="0" max="10" step="0.1" value="0"></div>
      <div class="row"><label>Clip-Bottom <span id="vb">0</span>%</label><input type="range" id="clip_b" min="0" max="10" step="0.1" value="0"></div>
      <div class="row"><label>Clip-Left <span id="vl">0</span>%</label><input type="range" id="clip_l" min="0" max="10" step="0.1" value="0"></div>
    </div>
    <div class="btns">
      <button id="reset">Сбросить</button>
      <button class="primary" id="copy">Скопировать CSS</button>
    </div>
  </div>

  <script>
    const root=document.documentElement;
    const qs=id=>document.getElementById(id);
    const sx=qs('scale_x'), sy=qs('scale_y'), ct=qs('clip_t'), cr=qs('clip_r'), cb=qs('clip_b'), cl=qs('clip_l');
    const vx=qs('vx'), vy=qs('vy'), vt=qs('vt'), vr=qs('vr'), vb=qs('vb'), vl=qs('vl');
    const resetBtn=qs('reset'), copyBtn=qs('copy');
    function apply(){
      root.style.setProperty('--scale-x',sx.value);
      root.style.setProperty('--scale-y',sy.value);
      root.style.setProperty('--clip-t',ct.value+'%');
      root.style.setProperty('--clip-r',cr.value+'%');
      root.style.setProperty('--clip-b',cb.value+'%');
      root.style.setProperty('--clip-l',cl.value+'%');
      vx.textContent=sx.value; vy.textContent=sy.value;
      vt.textContent=ct.value; vr.textContent=cr.value;
      vb.textContent=cb.value; vl.textContent=cl.value;
    }
    [sx,sy,ct,cr,cb,cl].forEach(el=>el.addEventListener('input',apply));
    qs('tunerToggle').addEventListener('click',()=>qs('tuner').classList.toggle('open'));
    resetBtn.addEventListener('click',()=>{sx.value=1; sy.value=1; ct.value=0; cr.value=0; cb.value=0; cl.value=0; apply();});
    copyBtn.addEventListener('click',()=>{
      const css=`:root{\\n  --scale-x: ${sx.value};\\n  --scale-y: ${sy.value};\\n  --clip-t: ${ct.value}%;\\n  --clip-r: ${cr.value}%;\\n  --clip-b: ${cb.value}%;\\n  --clip-l: ${cl.value}%;\\n}`;
      navigator.clipboard.writeText(css).then(()=>{copyBtn.textContent='Скопировано!'; setTimeout(()=>copyBtn.textContent='Скопировать CSS',1200);});
    });
    apply();
  </script>
</body>
</html>
